<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>

<title>团购网站</title>
<link rel="stylesheet" href="__PUBLIC__/css/cssnew/newhome/newhome.2.css" type="text/css" />
<link rel="stylesheet" href="__PUBLIC__/css/cssnew/newhome/login.css" type="text/css" />
<script type="text/javascript">
	
	function tableChange(obj){
	var newtab;
	var newdiv;
		if(obj=='login'){
			newtab = document.getElementById("logintab");
			newdiv = document.getElementById("logindiv");
		}else if(obj=='memberRigist'){
			newtab = document.getElementById("membertab");
			newdiv = document.getElementById("memberdiv");
		}else if(obj=='sellerRigist'){
			newtab = document.getElementById("sellertab");
			newdiv = document.getElementById("sellerdiv");
		}

		cleanAll();
		newtab.className = 'switch-bg1 J_switch_tab reg-switch-sel'; 
		newdiv.className = 'reg-switch-box J_switch_box'; 
	}
	function cleanAll(){
	
		document.getElementById("logintab").className='switch-bg1 J_switch_tab';
		document.getElementById("sellertab").className='switch-bg1 J_switch_tab';
		document.getElementById("membertab").className='switch-bg1 J_switch_tab';
		
		document.getElementById("logindiv").className= 'reg-switch-box J_switch_box Hide'; 
		document.getElementById("memberdiv").className= 'reg-switch-box J_switch_box Hide'; 
		document.getElementById("sellerdiv").className= 'reg-switch-box J_switch_box Hide'; 
	}
	
</script>
</head>
<body>
	<!---标题栏---->
		<include file="./Home/Tpl/Public/header.html"/>
	<!---标题栏---->
	
	<div class="head responsive">
		<!---Logo栏---->
			<include file="./Home/Tpl/Public/logobar.html"/>
		<!---Logo栏---->
	<script src="__PUBLIC__/js/jquery.validate.min.js" type="text/javascript"></script>
	<script src="__PUBLIC__/js/jquery.validate.messages_cn.js" type="text/javascript"></script>
	<script src="__PUBLIC__/js/jquery.metadata.js" type="text/javascript"></script>
	<script >
		$(document).ready(function(){
				$("#RegisterForm").validate({ 
					SubmitHandler:function(){ 
					alert( "success"); 
					}
					});
		});
	</script>
	<script >
		$(document).ready(function(){
				$("#LoginForm").validate({ 
					SubmitHandler:function(){ 
					alert( "success"); 
					}
					});
		});
	</script>
		<style type="text/css">
			#code
			{
				font-family:Arial;
				font-style:italic;
				font-weight:bold;
				border:0;
				letter-spacing:2px;
				color:blue;
				width:100px;
			}
		</style>

		<input id="tabSelect" value="{$tabSelect}" style="display:none"/>
		<div class="nav-bar">
			<div class="cont">
	
				<!-----主菜单---->
					<include file="./Home/Tpl/Public/menu.html"/>
				<!-----主菜单---->
			</div>
		</div>
	</div>
	
	<!---登陆栏---->
	<div class="pgm">
		<div class="main_w">
			<div class="page-sa box Form-box">
				<div class="box-t">
					<span class="box-tl"></span>
					<span class="box-tm"></span>
					<span class="box-tr"></span>
				</div>
				<div class="box-wrap">
					<div class="box-cont box-cont-new">
						<div class="login-cont J_cont">
							<div class="reg-switch J_switch">
								<span id="logintab" class="switch-bg1 J_switch_tab reg-switch-sel" onClick="tableChange('login')">用户登录</span>
								<span id="membertab" class="switch-bg1 J_switch_tab" onClick="tableChange('memberRigist')">会员注册</span>
								<span id="sellertab" class="switch-bg1 J_switch_tab" onClick="tableChange('sellerRigist')">商家注册</span>
							</div>
							<!---用户登录-->
							<form id="LoginForm" name="forml" action="__URL__/check" method="post">	
								<div id="logindiv" class="reg-switch-box J_switch_box">
									<div class="J_login Fix">									
										<ul class="login-new-ul">
											<li> 
												<span class="ws">账号</span>
												<input class="text J_login_username focus {required:true}" style="vertical-align:middle;height: 20px;" id="name" name="name" type="text" value="" tabindex="1" size="30" autocomplete="off" placeholder="请输入用户名"/>
												<span class="J_err input-error Hide"></span>
												<span class="prompt J_prmt Hide"></span>
											</li>
											<li class="sbmt">
												<span class="ws">密码</span>
												<input class="text foc J_login_password focus {required:true}" name="pwd" type="password" tabindex="2" autocomplete="off" style="vertical-align:middle;height: 20px;" />
												<a href="javascript:void(0)" onclick="javascript:findPswd();">
												<span>找回密码？</span>
												</a>
											</li>
											<li class="sbmt">
												<span class="ws">验证码</span>
												<input id="input" class="text" name="yz" type="text" tabindex="2" style="vertical-align:middle;height: 20px;" />	
												<input type = "button" id="code" onclick="createCode()"/>									
											</li>
										
											
											<li class="find" style="display:none"> 
												<span class="ws">验证邮箱</span>
												<input class="text foc J_login_password focus {required:true}" id="email" name="email" type="text" tabindex="2" autocomplete="off" style="vertical-align:middle;height: 20px;" placeholder="请输入注册时的邮箱"/>
											</li>
											<li class="J_action">
												<span class="ws">&nbsp;</span>
												<div class="login-btn-new">
													<button class="b-rbtn mob-login J_user_login sbmt" type="button" onclick="validate()" > <span>登 录</span></button>
													<button id="find-btn" type="button" class="b-rbtn mob-login J_user_login find" style="display:none" ><span>找回密码</span></button>
												</div>
											</li>
										</ul>
									</div>
								</div>	
							</form>	
							<!---会员注册-->
							<div id="memberdiv" class="reg-switch-box J_switch_box Hide">
								<div class="J_login Fix">
									<form id="RegisterForm" name="form2" action="__URL__/register" method="post">	
										<ul class="login-new-ul">
											<li> 
												<span class="ws">用户名</span>
												<input id="username" class="text J_login_username focus {required:true} ajaxCheck" style="vertical-align:middle; height: 20px;"
													   name="username" type="text" value="" tabindex="1" size="30" placeholder="用户名"/>
												<label class="name-err"></label>

											</li>
											<li>
												<span class="ws">密码</span>
												<input class="text foc J_login_password focus {required:true,minlength:6}" style="vertical-align:middle; height: 20px;"  name="password" type="password" tabindex="1" autocomplete="off"/>
										    <li><span class="ws">激活码</span>
												<input class="text J_login_username focus" style="vertical-align:middle; height: 20px;"  name="code" type="text" value="" tabindex="2" size="30" autocomplete="off"  placeholder="无激活码请留空"/>											
											</li>
											<li>
												<span class="ws">Email</span>
												<input id="email" class="text J_login_username focus {required:true,email:true} ajaxCheck"  style="vertical-align:middle; height: 20px;"  name="email" type="text" value="" tabindex="3" size="30" autocomplete="off"  placeholder="Email"/>
												<label class="email-err"></label>
											</li>
											<li>
												<span class="ws">车牌号</span>
												<input class="text J_login_username focus" style="vertical-align:middle; height: 20px;"  name="car_id" type="text" value="" tabindex="3" size="30" autocomplete="off"  placeholder="车牌号"/>
											
											</li>											
											<li>
												<span class="ws">手机号码</span>
												<input class="text J_login_username focus" style="vertical-align:middle; height: 20px;"   name="cellphone" type="text" value="" tabindex="4" size="30" autocomplete="off"  placeholder="手机号码"/>
								
											</li>											
											<li class="J_action">
												<span class="ws">&nbsp;</span>
												<div class="login-btn-new">
													<button class="b-rbtn mob-login J_user_login" type="submit"> <span>注 册</span> </button>
												</div>
											</li>
										</ul>
									</form>
								</div>
							</div>	
							
							<!---商家注册-->
							<div id="sellerdiv" class="reg-switch-box J_switch_box Hide">
								<div class="J_login Fix">
									<form action="" method="post">
										<ul class="login-new-ul">
											<li> <span class="ws">用户名</span>
												<input class="text J_login_username focus" style="vertical-align:middle; height: 20px;"   name="username" type="text"
                       value="" tabindex="1" size="30" autocomplete="off"
                       placeholder="用户名"/>
												<span class="J_err input-error Hide"></span><span class="prompt J_prmt Hide"></span></li>
												<li><span class="ws">密码</span>
												<input class="text foc J_login_password focus" name="password" type="password"
                       tabindex="2" autocomplete="off" style=" height: 20px;"/>
										   <li> <span class="ws">选择城市</span>
										   <?php
												$CityDB= M('city');
												$cityList=$CityDB->select();
										   ?>
												<select>
												<foreach name='cityList' item='city'>
													<option>{$city.city}</option>													
												</foreach>											
												</select>
												<span class="J_err input-error Hide"></span><span class="prompt J_prmt Hide"></span></li>
											<li> <span class="ws">手机号码</span>
												<input class="text J_login_username focus" name="code" type="text" value="" tabindex="1" size="30" autocomplete="off"
                       placeholder="手机号码" style=" height: 20px;" />
												<span class="J_err input-error Hide"></span><span class="prompt J_prmt Hide"></span></li>
												<li> <span class="ws">地址</span>
												<input class="text J_login_username focus" name="code" type="text" value="" tabindex="1" size="30" autocomplete="off"
                       placeholder="手机号码" style=" height: 20px;"/>
												<span class="J_err input-error Hide"></span><span class="prompt J_prmt Hide"></span></li>			   
											<li class="J_general_err Hide"> '
												<span class="ws">&nbsp;</span>
												<span class="J_err input-error Hide"></span>
												<span class="prompt J_prmt Hide"></span>
											</li>
											<li class="J_action">
												<span class="ws">&nbsp;</span>
												<div class="login-btn-new">
													<a class="b-rbtn mob-login J_user_login"> <span>注 册</span> </a>
												</div>
											</li>
										</ul>
									</form>
								</div>
							</div>

					</form>				
						</div>
						<div class="aside-right-new">
						<h2>注册须知</h2>										
							<p>1.请使用由英文或数字组成的用户名</p>
							<br/>
							<p>2.请设置密码长度至少6位以上</p>
							<br/>
							<p>3.请务必填写Email地址</p>
						</div>
						</div>
					</div>
				</div>
				<div class="box-b">
					<span class="box-bl"></span> <span class="box-bm"></span> <span class="box-br"></span>
				</div>
			</div>
		</div>
	</div>
	<!---footer-->
		<include file="./Home/Tpl/Public/footer.html"/>
	<!---footer-->
<!----找回密码---->
	<form id="findForm" name="loginForm" action="__URL__/findPswd" method="POST">
		<input name="username" type="text" style="display:none" class="find-name" />
		<input name="email" type="text" style="display:none" class="find-email" />
	</form>
<!----找回密码---->
</body>

<script>
			var code ; //在全局定义验证码 
			//产生验证码
			createCode();
			
			function createCode(){			
				 code = ""; 
				 var codeLength = 4;//验证码的长度	
				
				 var random = new Array(0,1,2,3,4,5,6,7,8,9,'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R',
				 'S','T','U','V','W','X','Y','Z');//随机数
				 for(var i = 0; i < codeLength; i++) {
				 //循环操作
					
					var index = Math.floor(Math.random()*36);
					//取得随机数的索引（0~35）
					
					code += random[index];
					//根据索引取得随机数加到code上
				}				
				$('#code').val(code);//把code值赋给验证码
			}
			//校验验证码
			function validate(){
				var inputCode = document.getElementById("input").value.toUpperCase(); //取得输入的验证码并转化为大写      
				if(inputCode.length <= 0) { //若输入的验证码长度为0
					alert("请输入验证码！"); //则弹出请输入验证码
				}       
				else if(inputCode != code ) { //若输入的验证码与产生的验证码不一致时
					alert("验证码输入错误"); //则弹出验证码输入错误
					createCode();//刷新验证码
					document.getElementById("input").value = "";//清空文本框
				}       
				else { //输入正确时
					$("#LoginForm").submit();
				}           
			}
	</script>
<script type="text/javascript">
var tab = $("#tabSelect").val();
if(tab=='memberRigist')
	{
		tableChange('memberRigist');
	}
function findPswd(){
			$(".find").attr('style',"");
			$(".sbmt").attr('style',"display:none");
		}
$("#find-btn").click(function(){
			$(".find-name").val($("#name").val());
			$(".find-email").val($("#email").val());
			$("#findForm").submit();
		});
</script>
<script>
	$(".ajaxCheck").change(function(){
		var key=$(this).attr('id');
		var value =$(this).val();
		$.ajax({
			type:"post",
			url:"__URL__/AjaxCheck",
			data:"data="+key+"-"+value,
			dataType:"html",
			error:function(){
				alert("当前ajax操作出错！");
			},
			success:function(msg){
				var obj = eval ("(" + msg + ")");
				if(obj.data=='false'){
					//校验失败	
					//alert('key='+key);						
					if(key=='email'){											
						$(".email-err").html(obj.info);								
					}
					else if(key=='username'){
					//alert(obj.info);
						$(".name-err").html(obj.info);	
					}
				}else{
					if(key=='email'){											
						$(".email-err").html('');								
					}
					else if(key=='name'){
						$(".name-err").html('');	
					}						
				}			
			}		  
		});		
	});
</script>
</html>
